(this.webpackJsonplibrary=this.webpackJsonplibrary||[]).push([[0],{74:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(27),a=n(4),o=n(58),s=n.n(o),i=n(10),u=n(9),l=n(24);function j(){var e=Object(l.a)(["\n  mutation editAuthor($name: String!, $setBornTo: Int!) {\n    editAuthor(name: $name, setBornTo: $setBornTo)  {\n      name\n      born\n      bookCount\n    }\n  }\n"]);return j=function(){return e},e}function b(){var e=Object(l.a)(["\nquery {\n  allAuthors  {\n    name,\n    born,\n    bookCount\n  }\n}\n"]);return b=function(){return e},e}function d(){var e=Object(l.a)(["\nmutation createNewBook($title: String!, $author: String!, $published: Int!, $genres:[String]!) {\n  addBook(\n    title: $title,\n    author: $author,\n    published: $published,\n    genres: $genres\n  ) {\n    title\n  }\n}\n"]);return d=function(){return e},e}function h(){var e=Object(l.a)(["\nquery findBookByTitle($bookToSearch: String!) {\n  findBook(title: $bookToSearch) {\n    title,\n    author{\n      name\n    },\n    published\n  }\n}\n"]);return h=function(){return e},e}function O(){var e=Object(l.a)(["\nquery {\n  allBooks  {\n    title\n    author{\n      name\n    } \n    published\n  }\n}\n"]);return O=function(){return e},e}function x(){var e=Object(l.a)(["\nmutation userLogin($username: String!, $password: String!) {\n  login(username: $username,password: $password) {\n    value\n  }\n}\n"]);return x=function(){return e},e}function v(){var e=Object(l.a)(["\nmutation createNewUser($username: String!,$favoriteGenre: String!) {\n  createUser(username: $username, favoriteGenre: $favoriteGenre) {\n    username,\n    favoriteGenre\n  }\n}\n"]);return v=function(){return e},e}Object(u.gql)(v());var f=Object(u.gql)(x()),p=Object(u.gql)(O()),m=Object(u.gql)(h()),g=Object(u.gql)(d()),k=Object(u.gql)(b()),y=Object(u.gql)(j()),S=function(e){var t=Object(a.useState)(""),n=Object(i.a)(t,2),o=n[0],s=n[1],l=Object(a.useState)(""),j=Object(i.a)(l,2),b=j[0],d=j[1],h=Object(u.useMutation)(y,{onError:function(e){console.log(e.Error)},update:function(e,t){var n=e.readQuery({query:k});e.writeQuery({query:k,data:Object(c.a)(Object(c.a)({},n),{},{allAuthors:n.allAuthors.map((function(e){return e.name===t.data.editAuthor.name?t.data.editAuthor:e}))})})}}),O=Object(i.a)(h,1)[0],x=e.authors;return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Set BirthYear"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),console.log(o),O({variables:{name:o,setBornTo:b}}),s(""),d("")},children:[Object(r.jsx)("div",{children:"Select Author"}),Object(r.jsxs)("select",{value:o,onChange:function(e){var t=e.target;return s(t.value)},children:[Object(r.jsx)("option",{value:"none",children:"none"}),x.map((function(e){return Object(r.jsx)("option",{value:e.name,children:e.name},e.name)}))]}),Object(r.jsxs)("div",{children:["Born Year",Object(r.jsx)("input",{type:"number",value:b,placeholder:"i.e: 1994",onChange:function(e){var t=e.target;return d(parseInt(t.value))}})]}),Object(r.jsx)("button",{className:"blueButton",type:"submit",children:"update author"})]})]})},B=function(e){var t=Object(u.useQuery)(k);if(!e.show)return null;if(t.loading)return Object(r.jsx)("div",{children:"loading..."});var n=t.data.allAuthors;return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Authors"}),Object(r.jsx)("table",{children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{className:"table-header",children:[Object(r.jsx)("th",{children:"Name"}),Object(r.jsx)("th",{children:"Born"}),Object(r.jsx)("th",{children:"Books"})]}),n.map((function(e){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:e.name}),Object(r.jsx)("td",{children:e.born}),Object(r.jsx)("td",{children:e.bookCount})]},e.name)}))]})}),Object(r.jsx)(S,{authors:n})]})},w=function(e){var t=Object(u.useQuery)(p),n=Object(u.useLazyQuery)(m),c=Object(i.a)(n,2),o=c[0],s=c[1],l=Object(a.useState)(null),j=Object(i.a)(l,2),b=j[0],d=j[1],h=function(e){o({variables:{bookToSearch:e}})};if(Object(a.useEffect)((function(){s.data&&d(s.data.findBook)}),[s]),b)return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:b.title}),Object(r.jsx)("div",{children:b.author}),Object(r.jsx)("button",{onClick:function(){return d(null)},children:"close"})]});if(!e.show)return null;if(t.loading)return Object(r.jsx)("div",{children:"loading..."});var O=t.data.allBooks;return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Books"}),Object(r.jsx)("table",{children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{className:"table-header",children:[Object(r.jsx)("th",{children:"Book Title"}),Object(r.jsx)("th",{children:"Author"}),Object(r.jsx)("th",{children:"Published"})]}),O.map((function(e){return Object(r.jsxs)("tr",{onClick:h,children:[Object(r.jsx)("td",{children:e.title}),Object(r.jsx)("td",{children:e.author.name}),Object(r.jsx)("td",{children:e.published})]},e.title)}))]})})]})},A=n(43),$=n.n(A),C=n(60),N=function(e){var t=Object(a.useState)(""),n=Object(i.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)(""),l=Object(i.a)(s,2),j=l[0],b=l[1],d=Object(a.useState)(""),h=Object(i.a)(d,2),O=h[0],x=h[1],v=Object(a.useState)(""),f=Object(i.a)(v,2),m=f[0],y=f[1],S=Object(a.useState)([]),B=Object(i.a)(S,2),w=B[0],A=B[1],N=Object(u.useMutation)(g,{refetchQueries:[{query:p},{query:k}],onError:function(e){console.log(e.Error)}}),T=Object(i.a)(N,1)[0];if(!e.show)return null;var q=function(){var e=Object(C.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("add book..."),T({variables:{title:c,author:j,published:O,genres:w}}),o(""),x(""),b(""),A([]),y("");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Create New Book"}),Object(r.jsxs)("form",{onSubmit:q,children:[Object(r.jsxs)("div",{children:["Title :",Object(r.jsx)("input",{value:c,placeholder:"Book Title",onChange:function(e){var t=e.target;return o(t.value)}})]}),Object(r.jsxs)("div",{children:["Author :",Object(r.jsx)("input",{value:j,placeholder:"Book Author",onChange:function(e){var t=e.target;return b(t.value)}})]}),Object(r.jsxs)("div",{children:["Published :",Object(r.jsx)("input",{type:"number",value:O,placeholder:"Published Year",onChange:function(e){var t=e.target;return x(parseInt(t.value))}})]}),Object(r.jsxs)("div",{style:{margin:10},children:["Genres:",Object(r.jsx)("p",{children:w.join(" ")})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)("input",{value:m,placeholder:"Book genre",onChange:function(e){var t=e.target;return y(t.value)}}),Object(r.jsx)("button",{className:"blueButton",onClick:function(){A(w.concat(m)),y("")},type:"button",children:"add genre"})]}),Object(r.jsx)("button",{className:"greenButton",type:"submit",children:"create book"})]})]})},T=function(e){var t=e.setError,n=e.setToken,c=Object(a.useState)(""),o=Object(i.a)(c,2),s=o[0],l=o[1],j="secred",b=Object(u.useMutation)(f,{onError:function(e){t(e.graphQLErrors[0].message)}}),d=Object(i.a)(b,2),h=d[0],O=d[1];Object(a.useEffect)((function(){if(O.data){var e=O.data.login.value;n(e),localStorage.setItem("libraryApp-userToken",e)}}),[O.data]);return Object(r.jsxs)("div",{children:[Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),h({variables:{username:s,password:j}})},children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{children:"Username:"}),Object(r.jsx)("input",{name:"username",placeholder:"username",onChange:function(e){var t=e.target;return l(t.value)}})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{children:"Password:"}),Object(r.jsx)("input",{type:"password",name:"password",defaultValue:j,placeholder:"password"})]}),Object(r.jsx)("button",{className:"greenButton",children:"login"})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h3",{children:"Test with"}),Object(r.jsxs)("p",{children:[Object(r.jsx)("strong",{children:"username: "}),"shivachit1"]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("strong",{children:"password: "}),"secred"]})]})]})},q=function(e){var t=e.errorMessage;return t?Object(r.jsx)("div",{style:{color:"red"},children:t}):null},E=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)("authors"),s=Object(i.a)(o,2),l=s[0],j=s[1],b=Object(a.useState)(null),d=Object(i.a)(b,2),h=d[0],O=d[1],x=Object(u.useApolloClient)();Object(a.useEffect)((function(){var e=localStorage.getItem("libraryApp-userToken");e&&c(e)}),[]);var v=function(e){O(e),setTimeout((function(){O(null)}),1e4)};return n?Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)("h2",{className:"header",children:"Library-App"}),Object(r.jsxs)("p",{children:[Object(r.jsx)("strong",{children:"Username:"})," shivachit1"]}),Object(r.jsx)("button",{className:"redButton",onClick:function(){return c(""),localStorage.clear(),void x.resetStore()},children:"Logout"}),Object(r.jsxs)("div",{children:[Object(r.jsx)("button",{className:"linkButton",onClick:function(){return j("authors")},children:"Authors"}),Object(r.jsx)("button",{className:"linkButton",onClick:function(){return j("books")},children:"Books"}),Object(r.jsx)("button",{className:"linkButton",onClick:function(){return j("add")},children:"Add book"})]}),Object(r.jsx)(q,{errorMessage:h}),Object(r.jsx)(N,{setError:v}),Object(r.jsx)(B,{show:"authors"===l}),Object(r.jsx)(w,{show:"books"===l}),Object(r.jsx)(N,{show:"add"===l})]}):Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)("h2",{children:"Library-App"}),Object(r.jsx)(q,{errorMessage:h}),Object(r.jsx)("h2",{className:"header",children:"Login"}),Object(r.jsx)(T,{setToken:c,setError:v})]})},I=(n(74),n(61)),L=Object(I.a)((function(e,t){var n=t.headers,r=localStorage.getItem("libraryApp-userToken");return{headers:Object(c.a)(Object(c.a)({},n),{},{authorization:r?"bearer ".concat(r):null})}})),M=new u.HttpLink({uri:"/graphql"}),Q=new u.ApolloClient({cache:new u.InMemoryCache,link:L.concat(M)});s.a.render(Object(r.jsx)(u.ApolloProvider,{client:Q,children:Object(r.jsx)(E,{})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.421c1c69.chunk.js.map